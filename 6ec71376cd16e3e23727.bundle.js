"use strict";(self.webpackChunkmy_webpack_project=self.webpackChunkmy_webpack_project||[]).push([[327],{24185:(e,t,r)=>{r.d(t,{Jv:()=>v,h9:()=>b,sc:()=>d});var n=r(91055),i=r(21851),o=r(7059),a=r.n(o);const c=["issueTime","expiryDate"],s=["issueTime","expiryDate"];function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}const f=(0,n.rJ)(i.db,"queues"),y=(0,n.rJ)(i.db,"services"),b=async({status:e,issueSource:t,serviceId:r,startDate:i,endDate:o})=>{const a=[...e?[(0,n._M)("status","==",e)]:[],...t?[(0,n._M)("issueSource","==",t)]:[],...r?[(0,n._M)("service","==",(0,n.H9)(y,r))]:[],...i?[(0,n._M)("issueTime",">=",i)]:[],...o?[(0,n._M)("issueTime","<=",o)]:[]],s=(0,n.P)(f,...a),l=await(0,n.GG)(s);return await Promise.all(l.docs.map((async e=>{const t=e.data(),{issueTime:r,expiryDate:i}=t,o=p(t,c),a=await(0,n.x7)(o.service),s=a.data(),l=u({id:a.id},s);return u(u({id:e.id},o),{},{issueTime:r.toDate(),expiryDate:i.toDate(),service:l})})))},d=async e=>{const t=await(0,n.x7)((0,n.H9)(f,e));if(!t.exists())return null;const r=t.data(),{issueTime:i,expiryDate:o}=r,a=p(r,s),c=await(0,n.x7)(a.service),l=c.data(),m=u({id:c.id},l);return u(u({id:t.id},a),{},{issueTime:i.toDate(),expiryDate:o.toDate(),service:m})},v=async e=>{try{const t=a()(),r=t.endOf("day"),o={serialNumber:await(async e=>{let t="";return e.usePrefix&&e.prefix&&(t+=e.prefix),t+="0001",e.useSuffix&&e.suffix&&(t+=e.suffix),t})(e.service),customer:e.customer,status:"WAITING",issueTime:t.toDate(),issueSource:e.issueSource,expiryDate:r.toDate(),service:(0,n.H9)(i.db,"services",e.service.id)},c=await(0,n.gS)(f,o),s=(await(0,n.x7)(c)).data();if(!s)throw new Error("Unable to add a queue");return{id:c.id,serialNumber:s.serialNumber,customer:s.customer,status:s.status,issueTime:s.issueTime.toDate(),expiryDate:s.expiryDate.toDate(),service:e.service,issueSource:s.issueSource}}catch(e){throw console.error("Error adding device: ",e),new Error("Unable to add a device")}}},74936:(e,t,r)=>{r.d(t,{Z1:()=>l,bU:()=>p,h1:()=>m,ko:()=>u});var n=r(91055),i=r(21851);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const s=(0,n.rJ)(i.db,"services"),l=async e=>{const t=[];e&&t.push((0,n._M)("status","==",e));const r=(0,n.P)(s,...t,(0,n.My)("code","asc"));return(await(0,n.GG)(r)).docs.map((e=>{const t=e.data();return a({id:e.id},t)}))},u=async e=>{const t=(0,n.P)(s,(0,n._M)("code","==",e),(0,n.AB)(1)),r=await(0,n.GG)(t);if(r.empty)return null;{const e=r.docs[0],t=e.data();return a({id:e.id},t)}},m=async e=>{console.log(e);try{return(await(0,n.gS)(s,e)).id}catch(e){throw console.error("Error adding service: ",e),new Error("Unable to add a service")}},p=async(e,t)=>{try{const r=(0,n.H9)(s,e);await(0,n.mZ)(r,t),console.log("Service updated successfully")}catch(e){throw console.error("Error updating service: ",e),new Error("Unable to update the service")}}},79543:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(77810);const i=["children","className"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(null,arguments)}const a=e=>{let{children:t,className:r}=e,a=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,i);return n.createElement("div",o({className:`card ${r||""}`},a),t)}},20831:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(77810),i=r(26038),o=r(68190);const a=({style:e})=>n.createElement(o.A,{align:"center",gap:"small",className:"form-note",style:e},n.createElement(i.Q3,null),n.createElement("span",null,"Là trường thông tin bắt buộc"))},71785:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(77810),i=r(62265),o=r(45958),a=r(84740);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c.apply(null,arguments)}const s=e=>{const[t,r]=(0,n.useState)(!1),s=(0,n.useMemo)((()=>t?n.createElement(i.A,{style:{color:"#FF7506"}}):n.createElement(o.A,{style:{color:"#FF7506"}})),[t]);return n.createElement(a.A,c({size:"large",suffixIcon:s},e,{onDropdownVisibleChange:e=>r(e)}))};s.Option=a.A.Option;const l=s},23523:(e,t,r)=>{r.d(t,{A4:()=>a,CP:()=>n,Fv:()=>o,zh:()=>i});const n=[{required:!0,message:"Vui lòng nhập số điện thoại"},{pattern:/^0([35789])[0-9]{8}$/,message:"Số điện thoại không hợp lệ"}],i=[{required:!0,message:"Vui lòng nhập họ tên"},()=>({validator:(e,t)=>!t||t.trim().length>3?Promise.resolve():Promise.reject(new Error("Họ tên không hợp lệ. Tối thiểu 3 ký tự"))})],o=[{required:!0,message:"Vui lòng nhập mật khẩu"},{min:8,message:"Mật khẩu phải có ít nhất 8 ký tự"},{pattern:/^\S*$/,message:"Mật khẩu không được chứa khoảng trắng"}],a=[{required:!0,message:"Vui lòng nhập mật khẩu"},({getFieldValue:e})=>({validator:(t,r)=>r&&e("password")!==r?Promise.reject(new Error("Mật khẩu không khớp")):Promise.resolve()})]},72355:(e,t,r)=>{r.d(t,{r:()=>o});var n=r(7059),i=r.n(n);const o=e=>i()(e).format("HH:mm - DD/MM/YYYY")},29200:(e,t,r)=>{r.d(t,{G:()=>c});var n=r(77810);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c=e=>{const[t,r]=(0,n.useState)({value:void 0,status:"ready",error:null}),i=(0,n.useCallback)((e=>(r((t=>o(o({},t),{},{status:"ready",value:e}))),Promise.resolve(e))),[]),a=(0,n.useCallback)((e=>(r((t=>o(o({},t),{},{status:"error",error:e}))),console.log(e),Promise.reject(e))),[]),c=(0,n.useCallback)(((...t)=>(r((e=>o(o({},e),{},{status:"loading",value:void 0,error:null}))),e(...t).then(i).catch(a))),[e,a,i]);return o({execute:c},t)}},29728:(e,t,r)=>{r.d(t,{A:()=>M});var n=r(77810),i=r(87026),o=r(77076),a=r(22523),c=r(43296),s=r(46995),l=r(69122),u=r.n(l),m=r(23256),p=r(37375),f=r(39577),y=r(1548),b=r(80018),d=r(14771),v=r(22698);const g=(0,p.U)((e=>{const{prefixCls:t,className:r,closeIcon:i,closable:o,type:a,title:c,children:s,footer:l}=e,p=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(e,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:g}=n.useContext(f.QO),h=g(),O=t||g("modal"),w=(0,y.A)(h),[j,P,E]=(0,v.Ay)(O,w),A=`${O}-confirm`;let S={};return S=a?{closable:null!=o&&o,title:"",footer:"",children:n.createElement(b.k,Object.assign({},e,{prefixCls:O,confirmPrefixCls:A,rootPrefixCls:h,content:s}))}:{closable:null==o||o,title:c,footer:null!==l&&n.createElement(d.w,Object.assign({},e)),children:s},j(n.createElement(m.Z,Object.assign({prefixCls:O,className:u()(P,`${O}-pure-panel`,a&&A,a&&`${A}-${a}`,r,E,w)},p,{closeIcon:(0,d.O)(O,i),closable:o},S)))}));var h=r(56606);function O(e){return(0,a.Ay)((0,a.fp)(e))}const w=s.A;w.useModal=h.A,w.info=function(e){return(0,a.Ay)((0,a.$D)(e))},w.success=function(e){return(0,a.Ay)((0,a.Ej)(e))},w.error=function(e){return(0,a.Ay)((0,a.jT)(e))},w.warning=O,w.warn=O,w.confirm=function(e){return(0,a.Ay)((0,a.lr)(e))},w.destroyAll=function(){for(;c.A.length;){const e=c.A.pop();e&&e()}},w.config=a.FB,w._InternalPanelDoNotUseOrYouWillBeFired=g;const j=w;var P=r(68190),E=r(6194),A=r(14856),S=r(20831),x=r(23523),D=r(64362),k=r(4504),T=r(72355),N=r(19569);const C=({isShow:e,setIsShow:t,queue:r})=>{const i=n.createElement(D.A,null,n.createElement(k.A,{flex:"auto"},n.createElement(P.A,{vertical:!0},n.createElement(E.A.Text,{style:{textAlign:"start"}},"Thời gian cấp:"),n.createElement(E.A.Text,{style:{textAlign:"start"}},"Hạn sử dụng:"))),n.createElement(k.A,{flex:"auto"},n.createElement(P.A,{vertical:!0},n.createElement(E.A.Text,null,(0,T.r)(r.issueTime)),n.createElement(E.A.Text,null,(0,T.r)(r.expiryDate)))));return n.createElement(j,{open:e,onCancel:()=>t(!1),className:"modal-queue-info",footer:i,closeIcon:n.createElement(N.A,{style:{fontSize:"150%"}})},n.createElement(P.A,{vertical:!0,justify:"center",align:"center",gap:"middle"},n.createElement("div",{className:"modal-queue-info__ticket-number-label"},"Số thứ tự được cấp"),n.createElement("div",{className:"modal-queue-info__ticket-number"},r.serialNumber),n.createElement("div",{className:"modal-queue-info__service-info"},"DV: ",r.service.name," ",n.createElement("strong",null,"(tại quầy số 1)"))))};var I=r(29200),_=r(24185);function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const M=({isShow:e,setIsShow:t,service:r,textOk:a="In số",source:c="Hệ thống"})=>{const[s]=i.A.useForm(),[l,u]=n.useState(!1),m=(0,I.G)(_.Jv),[p,f]=n.useState(null);return n.createElement(n.Fragment,null,n.createElement(o.Ay,{htmlType:"submit",type:"primary",size:"large"},a),n.createElement(j,{open:e,closable:!1,footer:null},n.createElement(P.A,{justify:"center",align:"center"},n.createElement(E.A.Title,{level:3},"Điền thông tin của bạn")),n.createElement(i.A,{layout:"vertical",form:s,onFinish:async e=>{if(r){const n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({name:e.name,phone:e.phone},e.email&&{email:e.email});await m.execute({customer:n,service:r,issueSource:c}).then((e=>{f(e),t(!1),u(!0),s.resetFields()})).catch((()=>f(null)))}}},n.createElement(i.A.Item,{label:"Họ và tên:",required:!0,name:"name",rules:x.zh},n.createElement(A.A,{placeholder:"Nhập họ và tên của bạn"})),n.createElement(i.A.Item,{label:"Số điện thoại:",required:!0,name:"phone",rules:x.CP},n.createElement(A.A,{placeholder:"Nhập số điện thoại của bạn"})),n.createElement(i.A.Item,{label:"Email:",name:"email",rules:[{type:"email",message:"Vui lòng nhập địa chỉ email hợp lệ"}]},n.createElement(A.A,{placeholder:"Nhập email của bạn"})),n.createElement(S.A,{style:{marginBottom:"4.9rem"}}),n.createElement(P.A,{align:"center",justify:"center"},n.createElement(P.A,{justify:"center",gap:"large"},n.createElement(o.Ay,{style:{backgroundColor:"#FFF2E7"},htmlType:"button",type:"primary",size:"large",ghost:!0,onClick:()=>{t(!1),s.resetFields()}},"Hủy bỏ"),n.createElement(o.Ay,{htmlType:"submit",type:"primary",size:"large"},"Xác nhận"))))),p&&n.createElement(C,{isShow:l,setIsShow:u,queue:p}))}},4504:(e,t,r)=>{r.d(t,{A:()=>n});const n=r(62924).A},64362:(e,t,r)=>{r.d(t,{A:()=>n});const n=r(18118).A}}]);