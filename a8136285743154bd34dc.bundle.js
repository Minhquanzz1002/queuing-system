"use strict";(self.webpackChunkmy_webpack_project=self.webpackChunkmy_webpack_project||[]).push([[745],{24185:(e,t,r)=>{r.d(t,{Jv:()=>b,h9:()=>v,sc:()=>y});var n=r(91055),a=r(21851),c=r(7059),i=r.n(c);const l=["issueTime","expiryDate"],s=["issueTime","expiryDate"];function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const f=(0,n.rJ)(a.db,"queues"),p=(0,n.rJ)(a.db,"services"),v=async({status:e,issueSource:t,serviceId:r,startDate:a,endDate:c})=>{const i=[...e?[(0,n._M)("status","==",e)]:[],...t?[(0,n._M)("issueSource","==",t)]:[],...r?[(0,n._M)("service","==",(0,n.H9)(p,r))]:[],...a?[(0,n._M)("issueTime",">=",a)]:[],...c?[(0,n._M)("issueTime","<=",c)]:[]],s=(0,n.P)(f,...i),o=await(0,n.GG)(s);return await Promise.all(o.docs.map((async e=>{const t=e.data(),{issueTime:r,expiryDate:a}=t,c=d(t,l),i=await(0,n.x7)(c.service),s=i.data(),o=u({id:i.id},s);return u(u({id:e.id},c),{},{issueTime:r.toDate(),expiryDate:a.toDate(),service:o})})))},y=async e=>{const t=await(0,n.x7)((0,n.H9)(f,e));if(!t.exists())return null;const r=t.data(),{issueTime:a,expiryDate:c}=r,i=d(r,s),l=await(0,n.x7)(i.service),o=l.data(),m=u({id:l.id},o);return u(u({id:t.id},i),{},{issueTime:a.toDate(),expiryDate:c.toDate(),service:m})},b=async e=>{try{const t=i()(),r=t.endOf("day"),c={serialNumber:await(async e=>{let t="";return e.usePrefix&&e.prefix&&(t+=e.prefix),t+="0001",e.useSuffix&&e.suffix&&(t+=e.suffix),t})(e.service),customer:e.customer,status:"WAITING",issueTime:t.toDate(),issueSource:e.issueSource,expiryDate:r.toDate(),service:(0,n.H9)(a.db,"services",e.service.id)},l=await(0,n.gS)(f,c),s=(await(0,n.x7)(l)).data();if(!s)throw new Error("Unable to add a queue");return{id:l.id,serialNumber:s.serialNumber,customer:s.customer,status:s.status,issueTime:s.issueTime.toDate(),expiryDate:s.expiryDate.toDate(),service:e.service,issueSource:s.issueSource}}catch(e){throw console.error("Error adding device: ",e),new Error("Unable to add a device")}}},74936:(e,t,r)=>{r.d(t,{Z1:()=>o,bU:()=>d,h1:()=>m,ko:()=>u});var n=r(91055),a=r(21851);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const s=(0,n.rJ)(a.db,"services"),o=async e=>{const t=[];e&&t.push((0,n._M)("status","==",e));const r=(0,n.P)(s,...t,(0,n.My)("code","asc"));return(await(0,n.GG)(r)).docs.map((e=>{const t=e.data();return i({id:e.id},t)}))},u=async e=>{const t=(0,n.P)(s,(0,n._M)("code","==",e),(0,n.AB)(1)),r=await(0,n.GG)(t);if(r.empty)return null;{const e=r.docs[0],t=e.data();return i({id:e.id},t)}},m=async e=>{console.log(e);try{return(await(0,n.gS)(s,e)).id}catch(e){throw console.error("Error adding service: ",e),new Error("Unable to add a service")}},d=async(e,t)=>{try{const r=(0,n.H9)(s,e);await(0,n.mZ)(r,t),console.log("Service updated successfully")}catch(e){throw console.error("Error updating service: ",e),new Error("Unable to update the service")}}},57975:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(77810),a=r(68190),c=r(81342);const i=({children:e,href:t,onClick:r,icon:i})=>{const l=n.createElement(a.A,{vertical:!0,align:"center",className:"action-button__item"},n.createElement("div",{className:"action-button__item--icon"},i),n.createElement("div",{className:"action-button__item--text"},e));return t?n.createElement(c.N_,{to:t},l):n.createElement("button",{onClick:r},l)},l=({children:e,style:t})=>{const r=n.Children.toArray(e).filter((e=>(0,n.isValidElement)(e)&&e.type===i));return n.createElement("div",{className:"action-button",style:t},r.map(((e,t)=>n.createElement(n.Fragment,{key:`action-${t}`},t>0&&n.createElement("div",{className:"action-button__separator"}),e))))};l.Item=i;const s=l},90194:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(77810),a=r(6620),c=r(26038),i=r(81342);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l.apply(null,arguments)}const s=e=>n.createElement(a.A,l({className:"breadcrumb",separator:n.createElement(c.Vj,{style:{color:"rgba(126, 125, 136, 1)"}}),itemRender:(e,t,r)=>r.indexOf(e)!==r.length-1&&e.href?n.createElement(i.N_,{className:"breadcrumb-link",to:e.href},e.title):n.createElement("span",{className:"breadcrumb-link"},e.title)},e))},79543:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(77810);const a=["children","className"];function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c.apply(null,arguments)}const i=e=>{let{children:t,className:r}=e,i=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,a);return n.createElement("div",c({className:`card ${r||""}`},i),t)}},60763:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(77810),a=r(14856);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c.apply(null,arguments)}const i=()=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},n.createElement("path",{d:"M9.16667 15.8333C12.8486 15.8333 15.8333 12.8486 15.8333 9.16667C15.8333 5.48477 12.8486 2.5 9.16667 2.5C5.48477 2.5 2.5 5.48477 2.5 9.16667C2.5 12.8486 5.48477 15.8333 9.16667 15.8333Z",stroke:"#FF7506",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),n.createElement("path",{d:"M17.5 17.5L13.875 13.875",stroke:"#FF7506",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})),l=e=>n.createElement(a.A,c({size:"large",suffix:n.createElement(i,null)},e))},82952:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(77810),a=r(68190),c=r(37088),i=r(77076),l=r(81342);const s=()=>n.createElement(a.A,{align:"center",justify:"center",style:{minHeight:"100vh"}},n.createElement(c.Ay,{status:404,title:"404",subTitle:"Đường dẫn không tồn tại",extra:n.createElement(l.N_,{to:"/dashboard"},n.createElement(i.Ay,{type:"primary"},"Back dashboard"))}))},71785:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(77810),a=r(62265),c=r(45958),i=r(84740);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l.apply(null,arguments)}const s=e=>{const[t,r]=(0,n.useState)(!1),s=(0,n.useMemo)((()=>t?n.createElement(a.A,{style:{color:"#FF7506"}}):n.createElement(c.A,{style:{color:"#FF7506"}})),[t]);return n.createElement(i.A,l({size:"large",suffixIcon:s},e,{onDropdownVisibleChange:e=>r(e)}))};s.Option=i.A.Option;const o=s},22295:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(77810),a=r(46983),c=r(8931),i=r(25084),l=r(1217),s=r(12959);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(null,arguments)}const u=e=>n.createElement(a.Ay,{theme:{components:{Table:{headerBg:"#FF9138",headerColor:"white",borderColor:"#FFE3CD",cellFontSize:14},Pagination:{itemActiveBg:"#FF7506",itemActiveColorDisabled:"white",itemBg:"none"}},token:{fontSize:16,fontWeightStrong:700}},renderEmpty:()=>n.createElement(c.A,{image:c.A.PRESENTED_IMAGE_SIMPLE,description:"Không có dữ liệu"})},n.createElement(i.A,o({},e,{rowHoverable:!1,pagination:{itemRender:(e,t,r)=>"prev"===t?n.createElement(l.A,{style:{color:"#A9A9B0"}}):"next"===t?n.createElement(s.A,{style:{color:"#A9A9B0"}}):r},rowClassName:(e,t)=>t%2==0?"":"bg-orange-50"})))},17192:(e,t,r)=>{r.d(t,{A:()=>b});var n=r(77810),a=r(68190),c=r(77076),i=r(75832),l=r(26038),s=r(81342),o=r(71468),u=r(8955),m=r(7059),d=r.n(m),f=r(29200),p=r(24185);const v=({name:e,date:t})=>n.createElement("div",{className:"notification-card"},n.createElement("div",{className:"notification-card__user"},"Người dùng: ",e),n.createElement("div",{className:"notification-card__time",title:`Thời gian nhận số: ${d()(t).format("HH[h]mm [ngày] DD/MM/YYYY")}`},"Thời gian nhận số: ",d()(t).format("HH[h]mm [ngày] DD/MM/YYYY"))),y=({open:e,setOpen:t})=>{const r=(0,n.useRef)(null);(0,u.A)(r,(()=>t(!1)));const[a,c]=(0,n.useState)([]),i=(0,f.G)(p.h9);return(0,n.useEffect)((()=>{i.execute({}).then(c).catch((()=>c([])))}),[]),e?n.createElement("div",{className:"topbar__notification-popup",ref:r},n.createElement("div",{className:"topbar__notification-popup__title"},"Thông báo"),n.createElement("div",{className:"topbar__notification-popup__content"},a.map(((e,t)=>n.createElement(n.Fragment,{key:t},t>0&&n.createElement("div",{className:"notification-card__divider"}),n.createElement(s.N_,{to:`/admin/cap-so/${e.id}`},n.createElement(v,{name:e.customer.name,date:e.expiryDate}))))))):null},b=()=>{const{user:e}=(0,o.d4)((e=>e.profile)),[t,r]=(0,n.useState)(!1);return n.createElement(a.A,{className:"topbar",align:"center",gap:"large"},n.createElement("div",{style:{position:"relative"}},n.createElement(c.Ay,{shape:"circle",className:"topbar__notification",onClick:e=>{e.stopPropagation(),r(!0)}},n.createElement(l.pY,null)),n.createElement(y,{open:t,setOpen:r})),n.createElement(a.A,{gap:"small",className:"topbar__user"},n.createElement(s.N_,{to:"/admin/ho-so"},n.createElement(i.A,{size:40,className:"topbar__avatar"},"A")),n.createElement(a.A,{vertical:!0,className:"topbar__info"},n.createElement("div",{className:"topbar__greeting"},"Xin chào"),n.createElement(s.N_,{to:"/admin/ho-so"},n.createElement("div",{className:"topbar__username"},e?.name||"Chưa rõ")))))}},29200:(e,t,r)=>{r.d(t,{G:()=>l});var n=r(77810);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const l=e=>{const[t,r]=(0,n.useState)({value:void 0,status:"ready",error:null}),a=(0,n.useCallback)((e=>(r((t=>c(c({},t),{},{status:"ready",value:e}))),Promise.resolve(e))),[]),i=(0,n.useCallback)((e=>(r((t=>c(c({},t),{},{status:"error",error:e}))),console.log(e),Promise.reject(e))),[]),l=(0,n.useCallback)(((...t)=>(r((e=>c(c({},e),{},{status:"loading",value:void 0,error:null}))),e(...t).then(a).catch(i))),[e,i,a]);return c({execute:l},t)}},8955:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(77810);const a=(e,t)=>{const r=(0,n.useCallback)((r=>{r&&e.current&&!e.current.contains(r.target)&&t(r)}),[e,t]);(0,n.useEffect)((()=>(document.addEventListener("mousedown",(e=>r(e)),!0),document.addEventListener("touchstart",(e=>r(e)),!0),()=>{document.removeEventListener("mousedown",r,!0),document.removeEventListener("touchstart",r,!0)})),[r])}},96745:(e,t,r)=>{r.r(t),r.d(t,{default:()=>P});var n=r(77810),a=r(68190),c=r(23079),i=r(6194),l=r(64362),s=r(4504),o=r(14856),u=r(87026),m=r(26038),d=r(17192),f=r(57975),p=r(79543),v=r(90194),y=r(29200),b=r(28689),E=r(82952),g=r(74936),h=r(71785),A=r(60763),O=r(22295),w=r(24185);const j=({label:e,value:t})=>n.createElement("div",{className:"service-detail__info-item"},n.createElement("div",{className:"service-detail__info-label"},e),n.createElement("div",{className:"service-detail__info-value"},t)),_=[{title:"Số thứ tự",dataIndex:"serialNumber",key:"queue_serialNumber"},{title:"Trạng thái",key:"queue_status",dataIndex:"status",render:e=>n.createElement(n.Fragment,null,"USED"===e?n.createElement(a.A,{gap:"small"},n.createElement(m.AB,{style:{color:"#7E7D88"}}),"Đã sử dụng"):"WAITING"===e?n.createElement(a.A,{gap:"small"},n.createElement(m.AB,{style:{color:"#4277FF"}}),"Đang chờ"):n.createElement(a.A,{gap:"small"},n.createElement(m.AB,{style:{color:"#E73F3F"}}),"Bỏ qua"))}],P=()=>{const{code:e}=(0,b.g)(),[t,r]=(0,n.useState)(null),[P,N]=(0,n.useState)([]),[x,D]=(0,n.useState)({status:"all"}),S=(0,y.G)(g.ko),k=(0,y.G)(w.h9);(0,n.useEffect)((()=>{S.execute(e).then(r).catch((()=>r(null)))}),[e]);const T=()=>{t&&k.execute({serviceId:t.id}).then(N).catch((()=>N([])))};return(0,n.useEffect)((()=>{T()}),[t]),(0,n.useEffect)((()=>{const{status:e}=x,r="all"===e?void 0:e;k.execute({status:r,serviceId:t?.id}).then(N).catch((()=>N([])))}),[x]),"loading"===S.status?n.createElement(a.A,{align:"center",justify:"center",className:"h-100vh"},n.createElement(c.A,{size:"large"})):t?n.createElement("div",{className:"service-detail"},n.createElement(a.A,{style:{padding:"2.4rem"},align:"center",justify:"space-between"},n.createElement(v.A,{items:[{title:"Dịch vụ"},{title:"Danh sách dịch vụ",href:"/admin/dich-vu"},{title:"Chi tiết"}]}),n.createElement(d.A,null)),n.createElement("div",{className:"service-detail__content"},n.createElement(i.A.Title,{level:3,style:{marginBottom:"1.6rem"}},"Quản lý dịch vụ"),n.createElement(l.A,{gutter:24},n.createElement(s.A,{flex:"37rem"},n.createElement(p.A,{style:{paddingInline:"1.6rem"}},n.createElement(i.A.Title,{level:4,style:{marginBottom:"1.2rem"}},"Thông tin dịch vụ"),n.createElement(a.A,{gap:"1.2rem",vertical:!0,className:"service-detail__info-grid"},n.createElement(j,{label:"Mã dịch vụ:",value:t.code}),n.createElement(j,{label:"Tên dịch vụ:",value:t.name}),t.description&&n.createElement(j,{label:"Mô tả:",value:t.description})),n.createElement(i.A.Title,{level:4,style:{marginBottom:"1.2rem"}},"Quy tắc cấp số"),n.createElement(a.A,{vertical:!0,gap:"1.2rem",style:{marginBottom:"2.4rem"}},n.createElement(l.A,null,n.createElement(s.A,{flex:"10rem"},n.createElement(a.A,{align:"center",className:"h-100"},"Tăng tự động:")),n.createElement(s.A,{flex:"auto"},n.createElement(a.A,{align:"center",gap:"small"},n.createElement(o.A,{size:"large",style:{width:"6.5rem"},value:t.fromNumber,readOnly:!0}),n.createElement("span",null,"đến"),n.createElement(o.A,{size:"large",style:{width:"6.5rem"},value:t.toNumber,readOnly:!0})))),t.usePrefix&&n.createElement(l.A,null,n.createElement(s.A,{flex:"10rem"},n.createElement(a.A,{align:"center",className:"h-100"},"Prefix:")),n.createElement(s.A,{flex:"auto"},n.createElement(o.A,{size:"large",style:{width:"6.5rem"},value:t.prefix,readOnly:!0}))),t.useSuffix&&n.createElement(l.A,null,n.createElement(s.A,{flex:"10rem"},n.createElement(a.A,{align:"center",className:"h-100"},"Suffix:")),n.createElement(s.A,{flex:"auto"},n.createElement(o.A,{size:"large",style:{width:"6.5rem"},value:t.suffix,readOnly:!0}))),t.isDaily&&n.createElement("div",null,"Reset mỗi ngày"),n.createElement("div",null,"Ví dụ: ",`${t.usePrefix?t.prefix:""}${t.useFromToNumber?t.fromNumber:""}${t.useSuffix?t.suffix:""}`)))),n.createElement(s.A,{flex:1},n.createElement(p.A,null,n.createElement(u.A,{layout:"vertical",onValuesChange:(e,t)=>{D(t)},initialValues:x},n.createElement(a.A,{align:"center",justify:"space-between",wrap:!0},n.createElement(u.A.Item,{label:"Trạng thái",name:"status"},n.createElement(h.A,{size:"large",style:{width:"16rem"}},n.createElement(h.A.Option,{key:"all"},"Tất cả"),n.createElement(h.A.Option,{key:"USED"},"Đã sử dụng"),n.createElement(h.A.Option,{key:"SKIPPED"},"Bỏ qua"),n.createElement(h.A.Option,{key:"WAITING"},"Đang chờ"))),n.createElement(u.A.Item,{label:"Từ khóa",name:"search"},n.createElement(A.A,{size:"large",placeholder:"Nhập từ khóa"})))),n.createElement(O.A,{bordered:!0,columns:_,dataSource:P,rowKey:e=>e.id}))))),n.createElement(f.A,null,n.createElement(f.A.Item,{icon:n.createElement(m.j4,null),onClick:T},"Cập nhật",n.createElement("br",null)," danh sách"),n.createElement(f.A.Item,{icon:n.createElement(m.UT,null),href:"/admin/dich-vu"},"Quay lại"))):n.createElement(E.A,null)}},4504:(e,t,r)=>{r.d(t,{A:()=>n});const n=r(62924).A},64362:(e,t,r)=>{r.d(t,{A:()=>n});const n=r(18118).A}}]);