"use strict";(self.webpackChunkmy_webpack_project=self.webpackChunkmy_webpack_project||[]).push([[170],{64341:(e,t,r)=>{r.d(t,{Im:()=>m,Z0:()=>d,c8:()=>u,oG:()=>o});var n=r(91055),a=r(21851);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const s=(0,n.rJ)(a.db,"devices"),o=async(e,t)=>{const r=[...e?[(0,n._M)("status","==",e)]:[],...void 0!==t?[(0,n._M)("connected","==",t)]:[]],a=(0,n.P)(s,...r,(0,n.My)("code","asc")),l=await(0,n.GG)(a);return await Promise.all(l.docs.map((async e=>{const t=e.data(),r=t.services||[],a=await Promise.all(r.map((async e=>{const t=await(0,n.x7)(e);if(!t.exists())return null;const r=t.data();return"object"!=typeof r?null:c({id:t.id},r)})));return c(c({id:e.id},t),{},{services:a})})))},d=async e=>{const t=(0,n.P)(s,(0,n._M)("code","==",e),(0,n.AB)(1)),r=await(0,n.GG)(t);if(r.empty)return null;{const e=r.docs[0],t=e.data(),a=t.services||[],l=await Promise.all(a.map((async e=>{const t=await(0,n.x7)(e);if(!t.exists())return null;const r=t.data();return"object"!=typeof r?null:c({id:t.id},r)})));return c(c({id:e.id},t),{},{services:l})}},m=async e=>{try{const t=c(c({},e),{},{services:e.services.map((e=>(0,n.H9)(a.db,"services",e)))});return(await(0,n.gS)(s,t)).id}catch(e){throw console.error("Error adding device: ",e),new Error("Unable to add a device")}},u=async(e,t)=>{try{const r=(0,n.H9)(a.db,"devices",e);if(t.services){const e=t.services.map((e=>(0,n.H9)(a.db,"services",e)));await(0,n.mZ)(r,c(c({},t),{},{services:e}))}else await(0,n.mZ)(r,t);console.log("Device updated successfully")}catch(e){throw console.error("Error updating device: ",e),new Error("Unable to update the device")}}},71785:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(77810),a=r(62265),l=r(45958),c=r(84740);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(null,arguments)}const s=e=>{const[t,r]=(0,n.useState)(!1),s=(0,n.useMemo)((()=>t?n.createElement(a.A,{style:{color:"#FF7506"}}):n.createElement(l.A,{style:{color:"#FF7506"}})),[t]);return n.createElement(c.A,i({size:"large",suffixIcon:s},e,{onDropdownVisibleChange:e=>r(e)}))};s.Option=c.A.Option;const o=s},10236:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});var n=r(77810),a=r(26038),l=r(17192),c=r(68190),i=r(6194),s=r(87026),o=r(22295),d=r(81342),m=r(57975),u=r(71785),p=r(60763),v=r(29200),h=r(64341),b=r(8955),y=r(75265),E=r(90194);const f=({services:e})=>{const[t,r]=(0,n.useState)(!1),a=(0,n.useRef)(null);(0,b.A)(a,(()=>r(!1)));const l=e.map((e=>e.name)).join(", ");return n.createElement("div",{style:{width:"25rem",position:"relative"}},n.createElement("div",{style:{textWrap:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},l),n.createElement(y.A,{onClick:()=>{r((e=>!e))}},"Xem thêm"),t&&n.createElement("div",{ref:a,style:{position:"absolute",zIndex:2,top:0,left:0,width:"160%",backgroundColor:"white",borderRadius:"8px",border:"1px solid #FFC89B",padding:"4px 8px"}},l))},w=[{title:"Mã thiết bị",dataIndex:"code",key:"device_code"},{title:"Tên thiết bị",dataIndex:"name",key:"device_name"},{title:"Địa chỉ IP",dataIndex:"ip",key:"device_ip"},{title:"Trạng thái hoạt động",key:"device_status",dataIndex:"status",render:e=>n.createElement(n.Fragment,null,"ACTIVE"===e?n.createElement(c.A,{gap:"small",className:"text-nowrap"},n.createElement(a.AB,{style:{color:"#35C75A"}})," Hoạt động"):n.createElement(c.A,{gap:"small",className:"text-nowrap"},n.createElement(a.AB,{style:{color:"#E73F3F"}}),"Ngưng hoạt động"))},{title:"Trạng thái kết nối",key:"device_connected",dataIndex:"connected",render:e=>n.createElement(n.Fragment,null,e?n.createElement(c.A,{gap:"small",className:"text-nowrap"},n.createElement(a.AB,{style:{color:"#35C75A"}})," Kết nối"):n.createElement(c.A,{gap:"small",className:"text-nowrap"},n.createElement(a.AB,{style:{color:"#E73F3F"}}),"Mất kết nối"))},{title:"Dịch vụ sử dụng",key:"device_services",dataIndex:"services",render:(e,{services:t})=>n.createElement(f,{services:t})},{title:"",key:"device_detail",render:(e,t)=>n.createElement(d.N_,{to:`/admin/thiet-bi/${t.code}`},n.createElement(y.A,null,"Chi tiết"))},{title:"",key:"device_update",render:(e,t)=>n.createElement(d.N_,{to:`/admin/thiet-bi/${t.code}/cap-nhat`},n.createElement(y.A,null,"Cập nhật"))}],g=()=>{const[e,t]=(0,n.useState)({status:"all",connected:"all",search:""}),[r,d]=(0,n.useState)([]),b=(0,v.G)(h.oG);return(0,n.useEffect)((()=>{b.execute().then(d).catch((()=>d([])))}),[]),(0,n.useEffect)((()=>{const{status:t,connected:r}=e,n="all"!==t?t:void 0,a="all"!==r?"true"===r:void 0;b.execute(n,a).then(d).catch((()=>d([])))}),[e]),n.createElement("div",null,n.createElement(c.A,{style:{padding:"2.4rem"},align:"center",justify:"space-between",wrap:"wrap"},n.createElement(E.A,{items:[{title:"Thiết bị"},{title:"Danh sách thiết bị"}]}),n.createElement(l.A,null)),n.createElement("div",{style:{paddingLeft:"2.4rem",paddingRight:"10.4rem"}},n.createElement(i.A.Title,{level:3,style:{marginBottom:"1.6rem"}},"Danh sách thiết bị"),n.createElement(s.A,{layout:"vertical",initialValues:e,onValuesChange:(e,r)=>{t(r)}},n.createElement(c.A,{justify:"space-between",wrap:"wrap"},n.createElement(c.A,{gap:"middle",wrap:!0},n.createElement(s.A.Item,{label:"Trạng thái hoạt động",name:"status"},n.createElement(u.A,{id:"status",style:{width:"30rem"},options:[{value:"all",label:"Tất cả"},{value:"ACTIVE",label:"Hoạt động"},{value:"INACTIVE",label:"Ngưng hoạt động"}]})),n.createElement(s.A.Item,{label:"Trạng thái kết nối",name:"connected"},n.createElement(u.A,{id:"connected",style:{width:"30rem"},options:[{value:"all",label:"Tất cả"},{value:"true",label:"Kết nối"},{value:"false",label:"Mất kết nối"}]}))),n.createElement(s.A.Item,{label:"Từ khóa",name:"search"},n.createElement(p.A,{id:"search",style:{width:"30rem"},placeholder:"Nhập từ khóa"})))),n.createElement("div",{style:{overflow:"hidden",borderRadius:"1.2rem"}},n.createElement(o.A,{bordered:!0,columns:w,dataSource:r,scroll:{x:"100%"},rowKey:e=>e.id}))),n.createElement(m.A,null,n.createElement(m.A.Item,{icon:n.createElement(a.Jr,null),href:"/admin/thiet-bi/them-moi"},"Thêm",n.createElement("br",null)," thiết bị")))}}}]);