"use strict";(self.webpackChunkmy_webpack_project=self.webpackChunkmy_webpack_project||[]).push([[977],{24185:(e,t,r)=>{r.d(t,{Jv:()=>g,h9:()=>y,sc:()=>v});var n=r(91055),a=r(21851),s=r(7059),i=r.n(s),o=r(65304);const c=["issueTime","expiryDate"],l=["issueTime","expiryDate"];function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const d=(0,n.rJ)(a.db,"queues"),b=(0,n.rJ)(a.db,"services"),y=async({status:e,issueSource:t,serviceId:r,startDate:a,endDate:s})=>{const i=[...e?[(0,n._M)("status","==",e)]:[],...t?[(0,n._M)("issueSource","==",t)]:[],...r?[(0,n._M)("service","==",(0,n.H9)(b,r))]:[],...a?[(0,n._M)("issueTime",">=",a)]:[],...s?[(0,n._M)("issueTime","<=",s)]:[]],o=(0,n.P)(d,...i),l=await(0,n.GG)(o);return await Promise.all(l.docs.map((async e=>{const t=e.data(),{issueTime:r,expiryDate:a}=t,s=p(t,c),i=await(0,n.x7)(s.service),o=i.data(),l=m({id:i.id},o);return m(m({id:e.id},s),{},{issueTime:r.toDate(),expiryDate:a.toDate(),service:l})})))},v=async e=>{const t=await(0,n.x7)((0,n.H9)(d,e));if(!t.exists())return null;const r=t.data(),{issueTime:a,expiryDate:s}=r,i=p(r,l),o=await(0,n.x7)(i.service),c=o.data(),u=m({id:o.id},c);return m(m({id:t.id},i),{},{issueTime:a.toDate(),expiryDate:s.toDate(),service:u})},g=async e=>{try{const t=i()(),r=t.endOf("day"),s=await(async e=>{let t="";return e.usePrefix&&e.prefix&&(t+=e.prefix),t+="0001",e.useSuffix&&e.suffix&&(t+=e.suffix),t})(e.service),c={serialNumber:s,customer:e.customer,status:"WAITING",issueTime:t.toDate(),issueSource:e.issueSource,expiryDate:r.toDate(),service:(0,n.H9)(a.db,"services",e.service.id)},l=await(0,n.gS)(d,c),u=(await(0,n.x7)(l)).data();if(!u)throw new Error("Unable to add a queue");return await(0,o.T)({action:`Cấp số ${s}`,ipAddress:"192.168.1.1"}),{id:l.id,serialNumber:u.serialNumber,customer:u.customer,status:u.status,issueTime:u.issueTime.toDate(),expiryDate:u.expiryDate.toDate(),service:e.service,issueSource:u.issueSource}}catch(e){throw console.error("Error adding device: ",e),new Error("Unable to add a device")}}},90194:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(77810),a=r(6620),s=r(26038),i=r(81342);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(null,arguments)}const c=e=>n.createElement(a.A,o({className:"breadcrumb",separator:n.createElement(s.Vj,{style:{color:"rgba(126, 125, 136, 1)"}}),itemRender:(e,t,r)=>r.indexOf(e)!==r.length-1&&e.href?n.createElement(i.N_,{className:"breadcrumb-link",to:e.href},e.title):n.createElement("span",{className:"breadcrumb-link"},e.title)},e))},79543:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(77810);const a=["children","className"];function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(null,arguments)}const i=e=>{let{children:t,className:r}=e,i=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,a);return n.createElement("div",s({className:`card ${r||""}`},i),t)}},17192:(e,t,r)=>{r.d(t,{A:()=>v});var n=r(77810),a=r(68190),s=r(77076),i=r(75832),o=r(26038),c=r(81342),l=r(71468),u=r(8955),m=r(7059),f=r.n(m),p=r(29200),d=r(24185);const b=({name:e,date:t})=>n.createElement("div",{className:"notification-card"},n.createElement("div",{className:"notification-card__user"},"Người dùng: ",e),n.createElement("div",{className:"notification-card__time",title:`Thời gian nhận số: ${f()(t).format("HH[h]mm [ngày] DD/MM/YYYY")}`},"Thời gian nhận số: ",f()(t).format("HH[h]mm [ngày] DD/MM/YYYY"))),y=({open:e,setOpen:t})=>{const r=(0,n.useRef)(null);(0,u.A)(r,(()=>t(!1)));const[a,s]=(0,n.useState)([]),i=(0,p.G)(d.h9);return(0,n.useEffect)((()=>{i.execute({}).then(s).catch((()=>s([])))}),[]),e?n.createElement("div",{className:"topbar__notification-popup",ref:r},n.createElement("div",{className:"topbar__notification-popup__title"},"Thông báo"),n.createElement("div",{className:"topbar__notification-popup__content"},a.map(((e,t)=>n.createElement(n.Fragment,{key:t},t>0&&n.createElement("div",{className:"notification-card__divider"}),n.createElement(c.N_,{to:`/admin/cap-so/${e.id}`},n.createElement(b,{name:e.customer.name,date:e.expiryDate}))))))):null},v=()=>{const{user:e}=(0,l.d4)((e=>e.profile)),[t,r]=(0,n.useState)(!1);return n.createElement(a.A,{className:"topbar",align:"center",gap:"large"},n.createElement("div",{style:{position:"relative"}},n.createElement(s.Ay,{shape:"circle",className:"topbar__notification",onClick:e=>{e.stopPropagation(),r(!0)}},n.createElement(o.pY,null)),n.createElement(y,{open:t,setOpen:r})),n.createElement(a.A,{gap:"small",className:"topbar__user"},n.createElement(c.N_,{to:"/admin/ho-so"},n.createElement(i.A,{size:40,className:"topbar__avatar"},"A")),n.createElement(a.A,{vertical:!0,className:"topbar__info"},n.createElement("div",{className:"topbar__greeting"},"Xin chào"),n.createElement(c.N_,{to:"/admin/ho-so"},n.createElement("div",{className:"topbar__username"},e?.name||"Chưa rõ")))))}},29200:(e,t,r)=>{r.d(t,{G:()=>o});var n=r(77810);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o=e=>{const[t,r]=(0,n.useState)({value:void 0,status:"ready",error:null}),a=(0,n.useCallback)((e=>(r((t=>s(s({},t),{},{status:"ready",value:e}))),Promise.resolve(e))),[]),i=(0,n.useCallback)((e=>(r((t=>s(s({},t),{},{status:"error",error:e}))),console.log(e),Promise.reject(e))),[]),o=(0,n.useCallback)(((...t)=>(r((e=>s(s({},e),{},{status:"loading",value:void 0,error:null}))),e(...t).then(a).catch(i))),[e,i,a]);return s({execute:o},t)}},8955:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(77810);const a=(e,t)=>{const r=(0,n.useCallback)((r=>{r&&e.current&&!e.current.contains(r.target)&&t(r)}),[e,t]);(0,n.useEffect)((()=>(document.addEventListener("mousedown",(e=>r(e)),!0),document.addEventListener("touchstart",(e=>r(e)),!0),()=>{document.removeEventListener("mousedown",r,!0),document.removeEventListener("touchstart",r,!0)})),[r])}},4504:(e,t,r)=>{r.d(t,{A:()=>n});const n=r(62924).A},98617:(e,t,r)=>{r.d(t,{Ay:()=>E});var n=r(13322),a=r(77810),s=r(77794),i=r(81230),o=r(39577),c=r(46983),l=r(741),u=r(90403),m=r(66241);let f=null,p=e=>e(),d=[],b={};function y(){const{getContainer:e,duration:t,rtl:r,maxCount:n,top:a}=b,s=(null==e?void 0:e())||document.body;return{getContainer:()=>s,duration:t,rtl:r,maxCount:n,top:a}}const v=a.forwardRef(((e,t)=>{const{messageConfig:r,sync:n}=e,{getPrefixCls:s}=(0,a.useContext)(o.QO),c=b.prefixCls||s("message"),l=(0,a.useContext)(i.B),[m,f]=(0,u.y)(Object.assign(Object.assign(Object.assign({},r),{prefixCls:c}),l.message));return a.useImperativeHandle(t,(()=>{const e=Object.assign({},m);return Object.keys(e).forEach((t=>{e[t]=function(){return n(),m[t].apply(m,arguments)}})),{instance:e,sync:n}})),f})),g=a.forwardRef(((e,t)=>{const[r,n]=a.useState(y),s=()=>{n(y)};a.useEffect(s,[]);const i=(0,c.cr)(),o=i.getRootPrefixCls(),l=i.getIconPrefixCls(),u=i.getTheme(),m=a.createElement(v,{ref:t,sync:s,messageConfig:r});return a.createElement(c.Ay,{prefixCls:o,iconPrefixCls:l,theme:u},i.holderRender?i.holderRender(m):m)}));function O(){if(!f){const e=document.createDocumentFragment(),t={fragment:e};return f=t,void p((()=>{(0,s.X)(a.createElement(g,{ref:e=>{const{instance:r,sync:n}=e||{};Promise.resolve().then((()=>{!t.instance&&r&&(t.instance=r,t.sync=n,O())}))}}),e)}))}f.instance&&(d.forEach((e=>{const{type:t,skipped:r}=e;if(!r)switch(t){case"open":p((()=>{const t=f.instance.open(Object.assign(Object.assign({},b),e.config));null==t||t.then(e.resolve),e.setCloseFn(t)}));break;case"destroy":p((()=>{null==f||f.instance.destroy(e.key)}));break;default:p((()=>{var r;const a=(r=f.instance)[t].apply(r,(0,n.A)(e.args));null==a||a.then(e.resolve),e.setCloseFn(a)}))}})),d=[])}const h={open:function(e){const t=(0,m.E)((t=>{let r;const n={type:"open",config:e,resolve:t,setCloseFn:e=>{r=e}};return d.push(n),()=>{r?p((()=>{r()})):n.skipped=!0}}));return O(),t},destroy:e=>{d.push({type:"destroy",key:e}),O()},config:function(e){b=Object.assign(Object.assign({},b),e),p((()=>{var e;null===(e=null==f?void 0:f.sync)||void 0===e||e.call(f)}))},useMessage:u.A,_InternalPanelDoNotUseOrYouWillBeFired:l.Ay};["success","info","warning","error","loading"].forEach((e=>{h[e]=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(e,t){(0,c.cr)();const r=(0,m.E)((r=>{let n;const a={type:e,args:t,resolve:r,setCloseFn:e=>{n=e}};return d.push(a),()=>{n?p((()=>{n()})):a.skipped=!0}}));return O(),r}(e,r)}}));const E=h},64362:(e,t,r)=>{r.d(t,{A:()=>n});const n=r(18118).A}}]);