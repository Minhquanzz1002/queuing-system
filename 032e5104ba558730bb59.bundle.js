"use strict";(self.webpackChunkmy_webpack_project=self.webpackChunkmy_webpack_project||[]).push([[877],{24185:(e,t,r)=>{r.d(t,{Jv:()=>E,h9:()=>f,sc:()=>y});var a=r(91055),n=r(21851),c=r(7059),l=r.n(c),i=r(65304);const s=["issueTime","expiryDate"],o=["issueTime","expiryDate"];function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.includes(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const v=(0,a.rJ)(n.db,"queues"),b=(0,a.rJ)(n.db,"services"),f=async({status:e,issueSource:t,serviceId:r,startDate:n,endDate:c})=>{const l=[...e?[(0,a._M)("status","==",e)]:[],...t?[(0,a._M)("issueSource","==",t)]:[],...r?[(0,a._M)("service","==",(0,a.H9)(b,r))]:[],...n?[(0,a._M)("issueTime",">=",n)]:[],...c?[(0,a._M)("issueTime","<=",c)]:[]],i=(0,a.P)(v,...l),o=await(0,a.GG)(i);return await Promise.all(o.docs.map((async e=>{const t=e.data(),{issueTime:r,expiryDate:n}=t,c=d(t,s),l=await(0,a.x7)(c.service),i=l.data(),o=m({id:l.id},i);return m(m({id:e.id},c),{},{issueTime:r.toDate(),expiryDate:n.toDate(),service:o})})))},y=async e=>{const t=await(0,a.x7)((0,a.H9)(v,e));if(!t.exists())return null;const r=t.data(),{issueTime:n,expiryDate:c}=r,l=d(r,o),i=await(0,a.x7)(l.service),s=i.data(),u=m({id:i.id},s);return m(m({id:t.id},l),{},{issueTime:n.toDate(),expiryDate:c.toDate(),service:u})},E=async e=>{try{const t=l()(),r=t.endOf("day"),c=await(async e=>{let t="";return e.usePrefix&&e.prefix&&(t+=e.prefix),t+="0001",e.useSuffix&&e.suffix&&(t+=e.suffix),t})(e.service),s={serialNumber:c,customer:e.customer,status:"WAITING",issueTime:t.toDate(),issueSource:e.issueSource,expiryDate:r.toDate(),service:(0,a.H9)(n.db,"services",e.service.id)},o=await(0,a.gS)(v,s),u=(await(0,a.x7)(o)).data();if(!u)throw new Error("Unable to add a queue");return await(0,i.T)({action:`Cấp số ${c}`,ipAddress:"192.168.1.1"}),{id:o.id,serialNumber:u.serialNumber,customer:u.customer,status:u.status,issueTime:u.issueTime.toDate(),expiryDate:u.expiryDate.toDate(),service:e.service,issueSource:u.issueSource}}catch(e){throw console.error("Error adding device: ",e),new Error("Unable to add a device")}}},57975:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(77810),n=r(68190),c=r(81342);const l=({children:e,href:t,onClick:r,icon:l})=>{const i=a.createElement(n.A,{vertical:!0,align:"center",className:"action-button__item"},a.createElement("div",{className:"action-button__item--icon"},l),a.createElement("div",{className:"action-button__item--text"},e));return t?a.createElement(c.N_,{to:t},i):a.createElement("button",{onClick:r},i)},i=({children:e,style:t})=>{const r=a.Children.toArray(e).filter((e=>(0,a.isValidElement)(e)&&e.type===l));return a.createElement("div",{className:"action-button",style:t},r.map(((e,t)=>a.createElement(a.Fragment,{key:`action-${t}`},t>0&&a.createElement("div",{className:"action-button__separator"}),e))))};i.Item=l;const s=i},90194:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(77810),n=r(6620),c=r(26038),l=r(81342);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},i.apply(null,arguments)}const s=e=>a.createElement(n.A,i({className:"breadcrumb",separator:a.createElement(c.Vj,{style:{color:"rgba(126, 125, 136, 1)"}}),itemRender:(e,t,r)=>r.indexOf(e)!==r.length-1&&e.href?a.createElement(l.N_,{className:"breadcrumb-link",to:e.href},e.title):a.createElement("span",{className:"breadcrumb-link"},e.title)},e))},79543:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(77810);const n=["children","className"];function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},c.apply(null,arguments)}const l=e=>{let{children:t,className:r}=e,l=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.includes(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)r=c[a],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,n);return a.createElement("div",c({className:`card ${r||""}`},l),t)}},82952:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(77810),n=r(68190),c=r(37088),l=r(77076),i=r(81342);const s=()=>a.createElement(n.A,{align:"center",justify:"center",style:{minHeight:"100vh"}},a.createElement(c.Ay,{status:404,title:"404",subTitle:"Đường dẫn không tồn tại",extra:a.createElement(i.N_,{to:"/dashboard"},a.createElement(l.Ay,{type:"primary"},"Back dashboard"))}))},17192:(e,t,r)=>{r.d(t,{A:()=>y});var a=r(77810),n=r(68190),c=r(77076),l=r(75832),i=r(26038),s=r(81342),o=r(71468),u=r(8955),m=r(7059),p=r.n(m),d=r(29200),v=r(24185);const b=({name:e,date:t})=>a.createElement("div",{className:"notification-card"},a.createElement("div",{className:"notification-card__user"},"Người dùng: ",e),a.createElement("div",{className:"notification-card__time",title:`Thời gian nhận số: ${p()(t).format("HH[h]mm [ngày] DD/MM/YYYY")}`},"Thời gian nhận số: ",p()(t).format("HH[h]mm [ngày] DD/MM/YYYY"))),f=({open:e,setOpen:t})=>{const r=(0,a.useRef)(null);(0,u.A)(r,(()=>t(!1)));const[n,c]=(0,a.useState)([]),l=(0,d.G)(v.h9);return(0,a.useEffect)((()=>{l.execute({}).then(c).catch((()=>c([])))}),[]),e?a.createElement("div",{className:"topbar__notification-popup",ref:r},a.createElement("div",{className:"topbar__notification-popup__title"},"Thông báo"),a.createElement("div",{className:"topbar__notification-popup__content"},n.map(((e,t)=>a.createElement(a.Fragment,{key:t},t>0&&a.createElement("div",{className:"notification-card__divider"}),a.createElement(s.N_,{to:`/admin/cap-so/${e.id}`},a.createElement(b,{name:e.customer.name,date:e.expiryDate}))))))):null},y=()=>{const{user:e}=(0,o.d4)((e=>e.profile)),[t,r]=(0,a.useState)(!1);return a.createElement(n.A,{className:"topbar",align:"center",gap:"large"},a.createElement("div",{style:{position:"relative"}},a.createElement(c.Ay,{shape:"circle",className:"topbar__notification",onClick:e=>{e.stopPropagation(),r(!0)}},a.createElement(i.pY,null)),a.createElement(f,{open:t,setOpen:r})),a.createElement(n.A,{gap:"small",className:"topbar__user"},a.createElement(s.N_,{to:"/admin/ho-so"},a.createElement(l.A,{size:40,className:"topbar__avatar"},"A")),a.createElement(n.A,{vertical:!0,className:"topbar__info"},a.createElement("div",{className:"topbar__greeting"},"Xin chào"),a.createElement(s.N_,{to:"/admin/ho-so"},a.createElement("div",{className:"topbar__username"},e?.name||"Chưa rõ")))))}},72355:(e,t,r)=>{r.d(t,{r:()=>c});var a=r(7059),n=r.n(a);const c=e=>n()(e).format("HH:mm - DD/MM/YYYY")},29200:(e,t,r)=>{r.d(t,{G:()=>i});var a=r(77810);function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const i=e=>{const[t,r]=(0,a.useState)({value:void 0,status:"ready",error:null}),n=(0,a.useCallback)((e=>(r((t=>c(c({},t),{},{status:"ready",value:e}))),Promise.resolve(e))),[]),l=(0,a.useCallback)((e=>(r((t=>c(c({},t),{},{status:"error",error:e}))),console.log(e),Promise.reject(e))),[]),i=(0,a.useCallback)(((...t)=>(r((e=>c(c({},e),{},{status:"loading",value:void 0,error:null}))),e(...t).then(n).catch(l))),[e,l,n]);return c({execute:i},t)}},8955:(e,t,r)=>{r.d(t,{A:()=>n});var a=r(77810);const n=(e,t)=>{const r=(0,a.useCallback)((r=>{r&&e.current&&!e.current.contains(r.target)&&t(r)}),[e,t]);(0,a.useEffect)((()=>(document.addEventListener("mousedown",(e=>r(e)),!0),document.addEventListener("touchstart",(e=>r(e)),!0),()=>{document.removeEventListener("mousedown",r,!0),document.removeEventListener("touchstart",r,!0)})),[r])}},93877:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var a=r(77810),n=r(68190),c=r(6194),l=r(64362),i=r(4504),s=r(26038),o=r(17192),u=r(57975),m=r(79543),p=r(90194),d=r(29200),v=r(28689),b=r(82952),f=r(24185);const y=({label:e,value:t})=>a.createElement(l.A,{className:"label-value-pair"},a.createElement(i.A,{flex:"15rem",className:"label-value-pair__label"},a.createElement(c.A.Text,{strong:!0,className:"label-value-pair__label-text"},e)),a.createElement(i.A,{flex:"auto",className:"label-value-pair__value"},a.createElement(c.A.Text,{className:"label-value-pair__value-text"},t)));var E=r(72355),g=r(70652);const h=()=>{const{id:e}=(0,v.g)(),[t,r]=(0,a.useState)(null),h=(0,d.G)(f.sc);return(0,a.useEffect)((()=>{e&&h.execute(e).then(r).catch((()=>r(null)))}),[e]),"loading"===h.status?a.createElement(g.A,null):t?a.createElement("div",{className:"queue-detail"},a.createElement(n.A,{style:{padding:"2.4rem"},align:"center",justify:"space-between"},a.createElement(p.A,{items:[{title:"Cấp số"},{title:"Danh sách cấp số",href:"/admin/cap-so"},{title:"Chi tiết"}]}),a.createElement(o.A,null)),a.createElement("div",{className:"queue-detail__content"},a.createElement(c.A.Title,{level:3,style:{marginBottom:"1.6rem"}},"Quản lý cấp số"),a.createElement(m.A,null,a.createElement(c.A.Title,{level:4,style:{marginBottom:"1.6rem"}},"Thông tin cấp số"),a.createElement(l.A,null,a.createElement(i.A,{span:12},a.createElement(n.A,{vertical:!0,gap:"1.6rem"},a.createElement(y,{label:"Họ tên:",value:t.customer.name}),a.createElement(y,{label:"Tên dịch vụ:",value:t.service.name}),a.createElement(y,{label:"Số thứ tự:",value:t.serialNumber}),a.createElement(y,{label:"Thời gian cấp:",value:(0,E.r)(t.issueTime)}),a.createElement(y,{label:"Hạn sử dụng:",value:(0,E.r)(t.expiryDate)}))),a.createElement(i.A,{span:12},a.createElement(n.A,{vertical:!0,gap:"1.6rem"},a.createElement(y,{label:"Nguồn cấp:",value:t.issueSource}),a.createElement(y,{label:"Trạng thái:",value:(_=t.status,"USED"===_?a.createElement(n.A,{gap:"small",align:"center"},a.createElement(s.AB,{style:{color:"#7E7D88"}}),"Đã sử dụng"):"WAITING"===_?a.createElement(n.A,{gap:"small",align:"center"},a.createElement(s.AB,{style:{color:"#4277FF"}}),"Đang chờ"):a.createElement(n.A,{gap:"small",align:"center"},a.createElement(s.AB,{style:{color:"#F9A825"}}),"Đã bỏ qua"))}),a.createElement(y,{label:"Số điện thoại:",value:t.customer.phone}),a.createElement(y,{label:"Địa chỉ email:",value:t.customer.email})))))),a.createElement(u.A,null,a.createElement(u.A.Item,{icon:a.createElement(s.UT,null),href:"/admin/cap-so"},"Quay lại"))):a.createElement(b.A,null);var _}},4504:(e,t,r)=>{r.d(t,{A:()=>a});const a=r(62924).A},64362:(e,t,r)=>{r.d(t,{A:()=>a});const a=r(18118).A}}]);