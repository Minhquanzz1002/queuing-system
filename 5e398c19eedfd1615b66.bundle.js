"use strict";(self.webpackChunkmy_webpack_project=self.webpackChunkmy_webpack_project||[]).push([[261],{64341:(e,t,r)=>{r.d(t,{Im:()=>m,Z0:()=>u,c8:()=>p,oG:()=>o});var n=r(91055),a=r(21851);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const l=(0,n.rJ)(a.db,"devices"),o=async(e,t)=>{const r=[...e?[(0,n._M)("status","==",e)]:[],...void 0!==t?[(0,n._M)("connected","==",t)]:[]],a=(0,n.P)(l,...r,(0,n.My)("code","asc")),i=await(0,n.GG)(a);return await Promise.all(i.docs.map((async e=>{const t=e.data(),r=t.services||[],a=await Promise.all(r.map((async e=>{const t=await(0,n.x7)(e);if(!t.exists())return null;const r=t.data();return"object"!=typeof r?null:c({id:t.id},r)})));return c(c({id:e.id},t),{},{services:a})})))},u=async e=>{const t=(0,n.P)(l,(0,n._M)("code","==",e),(0,n.AB)(1)),r=await(0,n.GG)(t);if(r.empty)return null;{const e=r.docs[0],t=e.data(),a=t.services||[],i=await Promise.all(a.map((async e=>{const t=await(0,n.x7)(e);if(!t.exists())return null;const r=t.data();return"object"!=typeof r?null:c({id:t.id},r)})));return c(c({id:e.id},t),{},{services:i})}},m=async e=>{try{const t=c(c({},e),{},{services:e.services.map((e=>(0,n.H9)(a.db,"services",e)))});return(await(0,n.gS)(l,t)).id}catch(e){throw console.error("Error adding device: ",e),new Error("Unable to add a device")}},p=async(e,t)=>{try{const r=(0,n.H9)(a.db,"devices",e);if(t.services){const e=t.services.map((e=>(0,n.H9)(a.db,"services",e)));await(0,n.mZ)(r,c(c({},t),{},{services:e}))}else await(0,n.mZ)(r,t);console.log("Device updated successfully")}catch(e){throw console.error("Error updating device: ",e),new Error("Unable to update the device")}}},74936:(e,t,r)=>{r.d(t,{Z1:()=>o,bU:()=>p,h1:()=>m,ko:()=>u});var n=r(91055),a=r(21851);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const l=(0,n.rJ)(a.db,"services"),o=async e=>{const t=[];e&&t.push((0,n._M)("status","==",e));const r=(0,n.P)(l,...t,(0,n.My)("code","asc"));return(await(0,n.GG)(r)).docs.map((e=>{const t=e.data();return c({id:e.id},t)}))},u=async e=>{const t=(0,n.P)(l,(0,n._M)("code","==",e),(0,n.AB)(1)),r=await(0,n.GG)(t);if(r.empty)return null;{const e=r.docs[0],t=e.data();return c({id:e.id},t)}},m=async e=>{console.log(e);try{return(await(0,n.gS)(l,e)).id}catch(e){throw console.error("Error adding service: ",e),new Error("Unable to add a service")}},p=async(e,t)=>{try{const r=(0,n.H9)(l,e);await(0,n.mZ)(r,t),console.log("Service updated successfully")}catch(e){throw console.error("Error updating service: ",e),new Error("Unable to update the service")}}},71785:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(77810),a=r(62265),i=r(45958),c=r(84740);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(null,arguments)}const l=e=>{const[t,r]=(0,n.useState)(!1),l=(0,n.useMemo)((()=>t?n.createElement(a.A,{style:{color:"#FF7506"}}):n.createElement(i.A,{style:{color:"#FF7506"}})),[t]);return n.createElement(c.A,s({size:"large",suffixIcon:l},e,{onDropdownVisibleChange:e=>r(e)}))};l.Option=c.A.Option;const o=l},74220:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});var n=r(77810),a=r(87026),i=r(98617),c=r(68190),s=r(6194),l=r(77076),o=r(17192),u=r(28689),m=r(81342),p=r(90194),d=r(29200),h=r(64341),b=r(43834);const g=()=>{const[e]=a.A.useForm(),t=(0,u.Zp)(),r=(0,d.G)(h.Im);return n.createElement("div",{className:"device-detail"},n.createElement(c.A,{style:{padding:"2.4rem"},align:"center",justify:"space-between"},n.createElement(p.A,{items:[{title:"Thiết bị"},{title:"Danh sách thiết bị",href:"/admin/thiet-bi"},{title:"Thêm thiết bị"}]}),n.createElement(o.A,null)),n.createElement("div",{style:{paddingLeft:"2.4rem",paddingRight:"6.4rem"}},n.createElement(s.A.Title,{level:3,style:{marginBottom:"1.6rem"}},"Quản lý thiết bị"),n.createElement(a.A,{form:e,onFinish:async e=>{try{await r.execute({code:e.code,type:e.type,status:"INACTIVE",connected:!1,name:e.name,username:e.username,password:e.password,ip:e.ip,services:e.services}),i.Ay.success("Thiết bị đã được thêm thành công",5),t("/admin/thiet-bi")}catch(e){i.Ay.error("Đã có lỗi xảy ra. Hãy thử lại sau!",5),console.error(e)}},layout:"vertical"},n.createElement(b.A,{form:e}),n.createElement(c.A,{justify:"center",gap:"large"},n.createElement(m.N_,{to:"/admin/thiet-bi"},n.createElement(l.Ay,{style:{backgroundColor:"#FFF2E7"},htmlType:"button",type:"primary",size:"large",ghost:!0},"Hủy bỏ")),n.createElement(l.Ay,{disabled:"loading"===r.status,htmlType:"submit",type:"primary",size:"large"},"Thêm thiết bị")))))}},43834:(e,t,r)=>{r.d(t,{A:()=>b});var n=r(77810),a=r(6194),i=r(64362),c=r(4504),s=r(87026),l=r(14856),o=r(68190),u=r(71785),m=r(26038),p=r(79543),d=r(29200),h=r(74936);const b=({form:e})=>{const[t,r]=(0,n.useState)([]),b=(0,d.G)(h.Z1);return(0,n.useEffect)((()=>{b.execute().then(r).catch((()=>r([])))}),[]),n.createElement(p.A,null,n.createElement(a.A.Title,{level:4,style:{marginBottom:"1.6rem"}},"Thông tin thiết bị"),n.createElement(i.A,{gutter:[24,0]},n.createElement(c.A,{span:12},n.createElement(s.A.Item,{label:"Mã thiết bị:",name:"code",required:!0,rules:[{required:!0,message:"Vui lòng nhập mã thiết bị"},{pattern:/^[a-zA-Z0-9_-]+$/,message:"Mã thiết bị chỉ bao gồm chữ cái, số, dấu gạch dưới và dấu gạch nối"}]},n.createElement(l.A,{placeholder:"Nhập mã thiết bị",size:"large",autoFocus:!0})),n.createElement(s.A.Item,{label:"Tên thiết bị:",required:!0,name:"name",rules:[{required:!0,message:"Vui lòng nhập tên thiết bị"},()=>({validator:(e,t)=>!t||t.trim().length>3?Promise.resolve():Promise.reject(new Error("Tên thiết bị không hợp lệ. Tối thiểu 3 ký tự"))})]},n.createElement(l.A,{placeholder:"Nhập tên thiết bị",size:"large"})),n.createElement(s.A.Item,{label:"Địa chỉ IP:",required:!0,name:"ip",rules:[{required:!0,message:"Vui lòng nhập IP"},{pattern:/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,message:"Địa chỉ IP không hợp lệ"}]},n.createElement(l.A,{placeholder:"Nhập địa chỉ IP",size:"large"}))),n.createElement(c.A,{span:12},n.createElement(s.A.Item,{label:"Loại thiết bị:",name:"type",required:!0,rules:[{required:!0,message:"Vui lòng loại thiết bị"}]},n.createElement(u.A,{placeholder:"Chọn loại thiết bị",options:[{label:"Kiosk",value:"Kiosk"},{label:"Display counter",value:"Display counter"}]})),n.createElement(s.A.Item,{label:"Tên đăng nhập:",required:!0,name:"username",rules:[{required:!0,message:"Vui lòng nhập tên đăng nhập"},{min:8,message:"Tên đăng nhập phải có ít nhất 8 ký tự"},{pattern:/^[a-zA-Z0-9@#$&]+$/,message:"Tên đăng nhập chỉ chứa chữ, số hoặc các ký tự @#$&"}]},n.createElement(l.A,{placeholder:"Nhập tài khoản",size:"large"})),n.createElement(s.A.Item,{label:"Mật khẩu:",required:!0,name:"password",rules:[{required:!0,message:"Vui lòng nhập mật khẩu"},{min:8,message:"Mật khẩu phải có ít nhất 8 ký tự"},{pattern:/^\S*$/,message:"Mật khẩu không được chứa khoảng trắng"}]},n.createElement(l.A.Password,{placeholder:"Nhập mật khẩu",size:"large"})))),n.createElement(s.A.Item,{label:"Dịch vụ sử dụng:",required:!0,name:"services",rules:[{required:!0,message:"Vui lòng chọn dịch vụ sử dụng"}]},n.createElement(u.A,{suffixIcon:null,mode:"multiple",placeholder:"Nhập dịch vụ sử dụng",onChange:r=>{r.includes("all")?e.setFieldsValue({services:t.map((e=>e.id))}):e.setFieldsValue({services:r})}},n.createElement(u.A.Option,{key:"all"},"Tất cả"),t.map((e=>n.createElement(u.A.Option,{key:e.id},e.name))))),n.createElement(o.A,{align:"center",gap:"small",style:{fontSize:"1.4rem",lineHeight:"2.1rem",color:"#7E7D88"}},n.createElement(m.Q3,null),n.createElement("span",null,"Là trường thông tin bắt buộc")))}}}]);